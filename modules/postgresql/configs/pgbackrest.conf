# pgBackRest Configuration for Homelab PostgreSQL
# Professional-grade incremental backup solution

[global]
# Repository Settings (Samsung T7 Touch)
repo1-type=posix
repo1-path=/backup/pgbackrest
repo1-retention-full=7        # Keep 7 full backups
repo1-retention-diff=4        # Keep 4 differential backups  
repo1-retention-archive=14    # Keep 14 days of WAL archives

# Compression and Encryption
repo1-cipher-type=aes-256-cbc
repo1-cipher-pass-file=/etc/pgbackrest/cipher.key
compress-type=lz4
compress-level=3

# Performance Settings
process-max=2                 # Use 2 parallel processes
archive-async=y               # Asynchronous archiving
archive-get-queue-max=1GB     # Queue up to 1GB of WAL

# Logging
log-level-console=info
log-level-file=detail
log-path=/var/log/pgbackrest
log-timestamp=n

# Backup Settings
start-fast=y                  # Fast checkpoint start
stop-auto=y                   # Auto-stop backup mode
backup-standby=n              # Not using standby server

[homelab]
# PostgreSQL Database Settings
pg1-host=localhost
pg1-port=5432
pg1-path=/var/lib/postgresql/data/pgdata
pg1-user=postgres
pg1-database=homelab
pg1-socket-path=/var/run/postgresql

# Recovery Settings
recovery-option=standby_mode=off
recovery-option=primary_conninfo=host=localhost port=5432 user=postgres